\begin{algorithm}[H]
    \begin{algorithmic}
        \Function{CreateFixupLoop}{$loop: \text{Loop}$}
            \State $loop' \gets\text{ }$ \Call{ExactCopy}{$loop$}
            \State $header \gets loop.header$
            \State $header' \gets loop'.header$
            \For{$succ \in header.successors$}
                \If{$succ.loop \notin loop$}
                    \State $succ.predecessors \gets succ.predecessors \backslash \{header\} \cup \{header'\}$
                \EndIf
            \EndFor
            \For{$node \in header$}
                \For{$succ \in header.successors$}
                    \If{$succ.loop \notin loop$}
                        \State $succ.predecessors \gets succ.predecessors \backslash \{node\} \cup \{node.link\}$
                    \EndIf
                \EndFor
            \EndFor
            \For{$phi \in header.phis$}
                \For{$pred \in phi.predecessors$}
                    \If{$pred \notin loop$}
                        \State $phi.link.predecessors \gets phi.link.predecessors \backslash \{pred\} \cup \{phi\}$
                    \EndIf
                \EndFor
            \EndFor
            \State $header'.predecessors \gets \{header.falseExit\}$
            \Comment{Now unroll $loop$}
        \EndFunction
    \end{algorithmic}
    \caption{The algorithm to create a fixup loop in~\libFIRM}
    \label{alg:impl:fixup:loop:fixup-loop}
\end{algorithm}